# 日本列島配船最適化ゲーム

海外の供給拠点から日本の需要都市へ貨物を輸送する戦略シミュレーションゲーム。

## 概要

プレイヤーは3隻の船を操り、30ターンの間、東京・札幌・福岡の在庫を枯渇させないように貨物を供給し続けることが目標。

## 技術スタック

- **フロントエンド**: React 19 + TypeScript
- **ビルドツール**: Vite 7
- **地図表示**: Leaflet + react-leaflet
- **スタイリング**: CSS

## 遊び方

1. **目的**: 30ターン生き残ること
2. **操作**:
   - 地図上の船をクリックして選択
   - 供給拠点で貨物を積み込む
   - 需要拠点に向けて出港
3. **注意**: 各都市の在庫が0未満になるとゲームオーバー

## ゲームルール

### 勝利条件
- 30ターン生き残る（全ての需要都市の在庫が0以上を維持）

### 敗北条件
- いずれかの需要都市の在庫が0未満になる

### ターンの流れ
1. **需要消費フェーズ**: 各需要都市で在庫が消費される
2. **到着・荷下ろしフェーズ**: 航行中の船が到着し、需要拠点では自動で荷下ろし
3. **供給生成フェーズ**: 各供給拠点で貨物が生成される
4. **ターン更新**: 次のターンへ

## 拠点

### 需要拠点（日本）

| ID | 名前 | 需要色 | 初期在庫 | 需要量（Lv1/Lv2/Lv3） |
|----|------|--------|----------|----------------------|
| TKO | 東京 | 赤 | 20 | 2 / 3 / 4 |
| SAP | 札幌 | 青 | 18 | 1 / 2 / 3 |
| FUK | 福岡 | 黄 | 20 | 2 / 3 / 4 |

### 供給拠点

| ID | 名前 | 赤/ターン | 青/ターン | 黄/ターン | 初期在庫（赤/青/黄） |
|----|------|-----------|-----------|-----------|---------------------|
| OKN | 沖縄 | 1 | 1 | 1 | 3 / 3 / 3 |
| RUS | ロシア | 1 | 2 | 0 | 3 / 6 / 0 |
| KOR | 韓国 | 1 | 0 | 1 | 3 / 0 / 3 |
| TAW | 台湾 | 2 | 0 | 1 | 6 / 0 / 3 |
| PHL | フィリピン | 0 | 0 | 2 | 0 / 0 / 6 |
| CHN | 上海 | 2 | 1 | 1 | 6 / 3 / 3 |
| GUM | グアム | 1 | 1 | 1 | 3 / 3 / 3 |
| PLW | パラオ | 0 | 2 | 1 | 0 / 6 / 3 |
| PNG | パプアニューギニア | 1 | 0 | 2 | 3 / 0 / 6 |
| OGS | 小笠原 | 1 | 1 | 0 | 3 / 3 / 0 |
| MHL | マーシャル | 0 | 1 | 2 | 0 / 3 / 6 |

※初期在庫 = 供給量 × 3ターン分

## 船

| タイプ | 名前 | 積載量 | 速度 | 積載色数 | 初期位置 |
|--------|------|--------|------|----------|----------|
| 大型船 | 大型船 | 10 | 1 | 1色のみ | 韓国 |
| 中型船 | 中型船 | 6 | 1 | 1色のみ | ロシア |
| 小型船 | 小型船 | 4 | 2 | 2色まで | 台湾 |

### 速度について
- **速度 = 1ターンに移動できるエッジ数**
- 大型船・中型船: 隣接する拠点（1エッジ先）のみ選択可能
- 小型船: 2エッジ先まで選択可能（例: 台湾→沖縄→小笠原を1ターンで移動）
- 全ての移動は1ターンで完了

## 航路ネットワーク

### 日本への航路（西側）
- ロシア ↔ 札幌
- 韓国 ↔ 福岡
- 上海 ↔ 福岡
- 台湾 ↔ 福岡
- 台湾 ↔ 沖縄
- フィリピン ↔ 沖縄

### 日本国内の航路
- 東京 ↔ 札幌
- 福岡 ↔ 東京
- 福岡 ↔ 沖縄

### 日本への航路（太平洋側）
- 小笠原 ↔ 東京
- 小笠原 ↔ 札幌

### 供給拠点間の航路（西側）
- ロシア ↔ 韓国
- 韓国 ↔ 上海
- 上海 ↔ 台湾
- 台湾 ↔ フィリピン

### 供給拠点間の航路（太平洋側）
- 沖縄 ↔ パラオ
- 沖縄 ↔ 小笠原
- 小笠原 ↔ グアム
- グアム ↔ パラオ
- パラオ ↔ フィリピン
- パラオ ↔ パプアニューギニア
- グアム ↔ マーシャル
- マーシャル ↔ パプアニューギニア

## 需要レベル

| レベル | ターン | 東京需要 | 札幌需要 | 福岡需要 |
|--------|--------|----------|----------|----------|
| Lv1 | 1-10 | 2 | 1 | 2 |
| Lv2 | 11-20 | 3 | 2 | 3 |
| Lv3 | 21-30 | 4 | 3 | 4 |

## プロジェクト構造

```
src/
├── components/
│   ├── Game.tsx          # メインゲームコンポーネント
│   ├── GameMap.tsx       # Leaflet地図表示
│   ├── GameMap.css       # 地図スタイル
│   ├── ShipControlPanel.tsx  # 船操作パネル
│   ├── InfoPanel.tsx     # 情報表示パネル
│   └── GanttChart.tsx    # ガントチャート
├── hooks/
│   └── useGameState.ts   # ゲーム状態管理（BFSによる到達可能判定含む）
├── config/
│   └── gameConfig.ts     # ゲーム設定（拠点、航路、船）
├── types/
│   └── game.ts           # TypeScript型定義
├── App.tsx
├── App.css
├── main.tsx
└── index.css
```

## 開発コマンド

```bash
# 依存関係のインストール
npm install

# 開発サーバー起動
npm run dev

# ビルド
npm run build

# リント
npm run lint

# プレビュー
npm run preview
```

## 主要な実装詳細

### 到達可能判定（useGameState.ts）
- `getDirectAdjacentPorts`: 1エッジ先の隣接港を取得
- `getReachablePorts`: BFSで指定エッジ数以内の到達可能港を探索
- `getAdjacentPorts`: 船のspeedに応じた到達可能港リストを返却

### 地図表示（GameMap.tsx）
- 中心座標: [20, 145]、ズーム: 4
- 港: CircleMarker（需要=赤、供給=緑）
- 船: DivIcon + 絵文字（🚢）
- ホバーでツールチップ表示（港名、在庫情報）

## 今後の開発予定

- [ ] ガントチャートによる船のスケジュール可視化
- [ ] 最適解の自動計算・ヒント機能
- [ ] スコアランキング
- [ ] リプレイ機能
- [ ] 難易度設定
